<<<<<<< Updated upstream
%% Layered architecture of the Documentation Generator
graph LR
    %% ==== API Layer ====
    subgraph API [API Layer]
        API_Server["FastAPI (api_server.py)"]
        API_Route_Git["/generate-from-git"]
        API_Route_Path["/generate-from-path"]
    end

    %% ==== Service / Orchestration Layer ====
    subgraph Service [Service (Crew) Layer]
        DocGenCrew["DocGenerator Crew (src/doc_generator/crew.py)"]
        ArchitectureAgent["Architecture Reasoning Agent"]
        APISemanticsAgent["API Semantics Agent"]
        ExamplesAgent["Examples Generation Agent"]
        GettingStartedAgent["Getting‑Started Agent"]
        DocumentAssembler["Document Assembler Agent"]
    end

    %% ==== Tool / Utility Layer ====
    subgraph Tools [Tool / Utility Layer]
        CodeAnalyzer["CodeAnalyzer Tool (tools/code_analyzer.py)"]
        DependencyAnalyzer["DependencyAnalyzer Tool (tools/dependency_analyzer.py)"]
        LanguageDetector["LanguageDetector Tool (tools/language_detector.py)"]
        StructureExtractor["StructureExtractor Tool (tools/structure_extractor.py)"]
        GuardrailsTool["Guardrails Tool (tools/guardrails.py)"]
        SharedMemoryTool["SharedMemory (tools/shared_memory.py)"]
        PostgreSQLStorage["PostgreSQLStorage Tool (tools/postgres_storage.py)"]
    end

    %% ==== Model Layer ====
    subgraph Models [Model Layer]
        DocumentationOutput["DocumentationOutput (models/documentation_output.py)"]
        CodeStructure["CodeStructure (models/code_structure.py)"]
    end

    %% ==== Data Layer ====
    subgraph Data [Data Layer]
        PostgreSQL["PostgreSQL DB (docgen table)"]
    end

    %% ==== External Integrations ====
    subgraph External [External Services]
        GitRepo["Git Repository"]
        ConfidentAI["Confident AI (metrics & tracing)"]
    end

    %% ==== Connections ====
    API_Server --> API_Route_Git
    API_Server --> API_Route_Path
    API_Route_Git -.-> GitRepo
    API_Route_Path -.-> (Local FS)

    API_Route_Git -->|trigger| DocGenCrew
    API_Route_Path -->|trigger| DocGenCrew

    DocGenCrew --> CodeAnalyzer
    DocGenCrew --> DependencyAnalyzer
    DocGenCrew --> LanguageDetector
    DocGenCrew --> StructureExtractor
    DocGenCrew --> GuardrailsTool
    DocGenCrew --> PostgreSQLStorage
    DocGenCrew --> ArchitectureAgent
    DocGenCrew --> APISemanticsAgent
    DocGenCrew --> ExamplesAgent
    DocGenCrew --> GettingStartedAgent
    DocGenCrew --> DocumentAssembler

    CodeAnalyzer --> SharedMemoryTool
    DependencyAnalyzer --> SharedMemoryTool
    LanguageDetector --> SharedMemoryTool
    StructureExtractor --> SharedMemoryTool
    GuardrailsTool --> SharedMemoryTool
    PostgreSQLStorage --> PostgreSQL

    SharedMemoryTool --> PostgreSQL
    DocumentationOutput -->|writes| docs_folder["/docs (static files)"]
    DocumentationOutput --> Models

    DocGenCrew ..> ConfidentAI : logs / evaluates
    PostgreSQLStorage ..> ConfidentAI : metric upload
    GuardrailsTool ..> ConfidentAI : validation results

    style API fill:#f9f,stroke:#333,stroke-width:2px
    style Service fill:#bbf,stroke:#333,stroke-width:2px
    style Tools fill:#bfb,stroke:#333,stroke-width:2px
    style Models fill:#ffb,stroke:#333,stroke-width:2px
    style Data fill:#ffe,stroke:#333,stroke-width:2px
=======
flowchart LR
    %% Presentation Layer
    subgraph Presentation[Presentation Layer]
        API[FastAPI (api_server.py)]
        UI[Frontend (docgen‑frontend)]
    end
    
    %% Application Layer
    subgraph Application[Application Layer]
        Main[Main Entrypoint (src/doc_generator/main.py)]
        Crew[DocGenerator Crew (src/doc_generator/crew.py)]
    end
    
    %% Domain / Model Layer
    subgraph Domain[Domain / Model Layer]
        CodeModel[CodeStructure Models (src/doc_generator/models/code_structure.py)]
        DocOut[DocumentationOutput Model (src/doc_generator/models/documentation_output.py)]
    end
    
    %% Infrastructure Layer
    subgraph Infrastructure[Infrastructure Layer]
        SM[SharedMemory (src/doc_generator/tools/shared_memory.py)]
        PG[PostgreSQLStorage (src/doc_generator/tools/postgres_storage.py)]
        CA[CodeAnalyzer Tool (src/doc_generator/tools/code_analyzer.py)]
        CP[ConfigParser Tool (src/doc_generator/tools/config_parser.py)]
        GA[Guardrails Tool (src/doc_generator/tools/guardrails.py)]
        MR[MemoryReader Tool (src/doc_generator/tools/memory_reader.py)]
        TA[TestAnalyzer Tool (src/doc_generator/tools/test_analyzer.py)]
        GE[GEval Metrics (src/doc_generator/geval_metrics.py)]
    end
    
    %% External Services
    subgraph External[External Services]
        DB[(PostgreSQL DB)]
        LLM[(Ollama LLM)]
        CI[(Confident AI Observability)]
        Git[(Git Repository)]
    end
    
    %% Relationships
    UI -- calls --> API
    API --> Main
    Main --> Crew
    Crew -- orchestrates --> CA
    Crew -- orchestrates --> CP
    Crew -- orchestrates --> GA
    Crew -- orchestrates --> TA
    Crew -- orchestrates --> GE
    Crew -- stores/retrieves --> SM
    SM -- persists --> DB
    PG -- writes traces --> DB
    CA -- writes parsed code --> SM
    CP -- writes config data --> SM
    MR -- reads shared data --> SM
    GA -- validates output --> SM
    TA -- writes test analysis --> SM
    GE -- evaluates docs --> SM
    LLM -- used by agents (via Crew) --> API
    CI -- receives traces & metrics --> Crew
    API -- clones --> Git
    style Presentation fill:#f9f,stroke:#333,stroke-width:2px
    style Application fill:#bbf,stroke:#333,stroke-width:2px
    style Domain fill:#bfb,stroke:#333,stroke-width:2px
    style Infrastructure fill:#ffb,stroke:#333,stroke-width:2px
>>>>>>> Stashed changes
    style External fill:#ddd,stroke:#333,stroke-width:2px